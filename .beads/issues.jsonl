{"id":"test-loom-27c","title":"Implement enricher pipeline with pluggable interfaces","description":"internal/enricher/ - Enricher interface + 5 implementations: grouper (by package), patterns (no-op), simplifier (prune+cap), annotator (no-op), scorer (equal weight). All have LLM-ready interfaces for iteration 2.","status":"closed","priority":2,"issue_type":"task","owner":"olesho@gmail.com","created_at":"2026-02-19T09:05:56.360211-06:00","created_by":"Oleh Luchkiv","updated_at":"2026-02-19T09:06:00.702199-06:00","closed_at":"2026-02-19T09:06:00.702199-06:00","close_reason":"All 5 enricher files implemented with default code-only implementations"}
{"id":"test-loom-2ul","title":"Fix color differentiation not rendering in browser for interfaces vs implementations","description":"The classDef and cssClass directives for color-coding interfaces (blue #2374ab) vs implementations (green #4a9c6d) are present in the generated Mermaid source but not rendering visually in the browser. The styles were added in mermaid.go but may not be taking effect with Mermaid.js v11 in-browser rendering. Need to investigate why and fix.","status":"closed","priority":1,"issue_type":"bug","owner":"olesho@gmail.com","created_at":"2026-02-19T16:25:51.602997-06:00","created_by":"Oleh Luchkiv","updated_at":"2026-02-19T16:43:48.291601-06:00","closed_at":"2026-02-19T16:43:48.291601-06:00","close_reason":"Closed"}
{"id":"test-loom-6oq","title":"Create initial git commit for goifaces","description":"Stage all project files and create the initial commit. Verify pre-commit hook runs lint + tests successfully. Do NOT commit logs/ or testdata/*/output.* files (gitignored).","status":"closed","priority":1,"issue_type":"task","owner":"olesho@gmail.com","created_at":"2026-02-19T09:05:44.018283-06:00","created_by":"Oleh Luchkiv","updated_at":"2026-02-19T10:55:38.076036-06:00","closed_at":"2026-02-19T10:55:38.076036-06:00","close_reason":"Initial commit 9f31a3a created. Pre-commit hook verified lint + tests pass."}
{"id":"test-loom-6t1","title":"Implement input resolver package","description":"internal/resolver/resolver.go - resolves local dirs, sub-package paths, and GitHub URLs (git clone --depth=1) to analyzable directories","status":"closed","priority":2,"issue_type":"task","owner":"olesho@gmail.com","created_at":"2026-02-19T09:05:48.459913-06:00","created_by":"Oleh Luchkiv","updated_at":"2026-02-19T09:05:52.258219-06:00","closed_at":"2026-02-19T09:05:52.258219-06:00","close_reason":"Implemented with local dir, GitHub URL clone, and go mod download"}
{"id":"test-loom-720","title":"Create Mermaid syntax verifier for CI and development","description":"Add a verification step that validates generated Mermaid code against Mermaid.js parser (not just mmdc CLI). Should catch syntax errors before serving to browser. Can use Node.js mermaid package or mmdc --parseOnly.","status":"closed","priority":1,"issue_type":"task","owner":"olesho@gmail.com","created_at":"2026-02-19T16:07:55.764085-06:00","created_by":"Oleh Luchkiv","updated_at":"2026-02-19T16:11:04.387828-06:00","closed_at":"2026-02-19T16:11:04.387828-06:00","close_reason":"Closed"}
{"id":"test-loom-7r8","title":"Implement structured logging package","description":"internal/logging/logging.go - slog JSON handler with dual output (stderr + file), Setup function returning logger and cleanup","status":"closed","priority":2,"issue_type":"task","owner":"olesho@gmail.com","created_at":"2026-02-19T09:05:30.406814-06:00","created_by":"Oleh Luchkiv","updated_at":"2026-02-19T09:05:35.054043-06:00","closed_at":"2026-02-19T09:05:35.054043-06:00","close_reason":"Implemented with slog JSONHandler and io.MultiWriter"}
{"id":"test-loom-86t","title":"Implement Mermaid diagram generator","description":"internal/diagram/mermaid.go - generates deterministic classDiagram syntax with sanitized IDs, method truncation, and sorted output","status":"closed","priority":1,"issue_type":"task","owner":"olesho@gmail.com","created_at":"2026-02-19T09:06:05.360739-06:00","created_by":"Oleh Luchkiv","updated_at":"2026-02-19T09:06:09.108986-06:00","closed_at":"2026-02-19T09:06:09.108986-06:00","close_reason":"Implemented with deterministic sorting, relevant method filtering, and pointer-receiver labels"}
{"id":"test-loom-873","title":"Mermaid syntax error in browser - Unicode sanitization chars not supported by Mermaid.js v11","description":"The sanitizeSignature() function in internal/diagram/mermaid.go replaces {}\u003c\u003e with Unicode alternatives (⦃⦄ᐊ‹›) that pass mmdc CLI rendering but fail in browser Mermaid.js v11.12.3. Need to use only ASCII-safe replacements that work in both contexts.","status":"closed","priority":1,"issue_type":"bug","owner":"olesho@gmail.com","created_at":"2026-02-19T15:48:38.349512-06:00","created_by":"Oleh Luchkiv","updated_at":"2026-02-19T16:11:04.294301-06:00","closed_at":"2026-02-19T16:11:04.294301-06:00","close_reason":"Closed"}
{"id":"test-loom-9q0","title":"Show only interfaces and relations on the first (overview) slide","description":"The first Mermaid chart, titled 'Overview', currently shows interfaces, implementations, and all details. It should instead be a unified map showing ONLY interfaces and their relations (dependency arrows between interfaces). No implementation blocks, no method bodies — just the interface nodes and how they connect. Only modify the 'Overview' chart; the chunked slides that follow should keep their current detail level.","design":"## Summary\n\nThe overview (first) slide currently shows ALL nodes (interfaces and implementations) with empty class bodies plus all type→interface relation arrows. This task changes the overview to show ONLY interface nodes and interface→interface embedding/extension arrows, producing a clean architectural map. Implementation blocks and implementation arrows are omitted entirely from the overview — they remain on the detail slides that follow.\n\n## Technical Approach\n\nThe change is localized to `generateOverviewMermaid()` in `internal/diagram/slides.go`. The function already has special logic for the overview (no method bodies). We extend this by:\n\n1. **Removing type/implementation blocks** — Delete the entire section that renders type class blocks (lines 168-177 in current code).\n2. **Replacing type→interface relations with interface→interface embedding arrows** — Instead of iterating `result.Relations` (which are type→interface), detect interface embedding using each `InterfaceDef.TypeObj` (`*types.Interface`). The `NumEmbeddeds()` and `EmbeddedType(i)` methods from Go's `go/types` package reveal which interfaces embed other interfaces.\n3. **Using a different arrow style** — Implementation uses `..|\u003e` (dashed + triangle). Interface embedding/extension should use `--|\u003e` (solid + triangle), following UML convention for inheritance/extension.\n4. **Handling nil TypeObj** — Synthetic test data may have nil `TypeObj`. When nil, skip embedding detection for that interface (no arrows drawn from it).\n5. **Removing implStyle** — Since no implementation blocks are rendered, remove `classDef implStyle` and its `cssClass` assignments from the overview output.\n\nIf a codebase has no interface embedding, the overview shows just the interface nodes (a useful \"table of contents\"). The detail slides remain unchanged.\n\n## Files to Modify\n\n### 1. `internal/diagram/slides.go` — `generateOverviewMermaid()`\n\n**Remove type blocks section (current lines ~168-177):**\n- Delete the loop that writes type class blocks\n- Delete the blank-line separator between interfaces and types\n\n**Replace relation rendering (current lines ~179-186):**\n- Remove the loop that writes `type ..|\u003e interface` arrows\n- Add new logic:\n  a. Build a lookup map: `pkgPath.Name → bool` for all interfaces in the result\n  b. For each interface with non-nil `TypeObj`, iterate `TypeObj.NumEmbeddeds()`\n  c. For each `TypeObj.EmbeddedType(i)`, check if it's a `*types.Named` whose `Obj().Pkg().Path() + \".\" + Obj().Name()` exists in the lookup\n  d. If so, write an embedding arrow: `childID --|\u003e parentID`\n  e. Sort embedding arrows deterministically\n\n**Remove implStyle references (current lines ~189-198):**\n- Remove `classDef implStyle ...` line from style definitions\n- Remove the loop that assigns `cssClass` to type nodes (since no type nodes exist)\n\n**Add a new helper function `writeEmbeddingRelation()`:**\n```go\nfunc writeEmbeddingRelation(b *strings.Builder, child, parent analyzer.InterfaceDef) {\n    childID := nodeID(child.PkgName, child.Name)\n    parentID := nodeID(parent.PkgName, parent.Name)\n    b.WriteString(fmt.Sprintf(\"    %s --|\u003e %s\", childID, parentID))\n}\n```\n\n### 2. `internal/integration_test.go` — `TestHubAndSpokeSlides`\n\n**Update overview assertions (around line 421-423):**\n- Keep the existing `assert.NotContains(t, overview, \"+\", \"overview should have no method lines\")` assertion\n- Add: overview should NOT contain any implementation node IDs (e.g., `memdb_BoolFieldIndex`, `memdb_FilterIterator`)\n- Add: overview should NOT contain `..|\u003e` arrows (implementation relations)\n- Add: overview SHOULD contain interface node IDs (`memdb_Indexer`, `memdb_MultiIndexer`, etc.)\n\n**Add a new test `TestOverviewInterfaceEmbedding`:**\n- Create synthetic data with 3 interfaces where one embeds the other two (like ReadCloser embedding Reader and Closer)\n- Use real `*types.Interface` objects (via `types.NewInterfaceType`) so `TypeObj` is populated\n- Verify the overview contains `--|\u003e` arrows between the embedding interface and its parents\n- Verify no implementation blocks or `..|\u003e` arrows appear\n\n### 3. `docs/architecture.md` — Update `internal/diagram` section\n\nUpdate the paragraph describing the diagram package to mention that the overview slide shows only interface nodes with embedding/extension arrows (`--|\u003e`), while detail slides show full interface+implementation diagrams with implementation arrows (`..|\u003e`).\n\n## Dependencies\n\n- No new external packages needed\n- Uses existing `go/types` stdlib for embedding detection (`types.Interface.NumEmbeddeds()`, `types.Interface.EmbeddedType()`)\n- No dependency on in-progress task test-loom-xf7 (that task modifies detail slide rendering in `mermaid.go`, not overview in `slides.go`)\n\n## Edge Cases \u0026 Error Handling\n\n1. **Nil TypeObj** — Synthetic test data or edge cases may have nil `TypeObj`. Skip embedding detection for these interfaces; they'll render as disconnected nodes.\n2. **Self-embedding** — Go doesn't allow it, but guard: skip if child == parent by key.\n3. **Embedded type is not *types.Named** — `EmbeddedType(i)` could return a non-Named type (e.g., type constraints in generics). Only process `*types.Named` types.\n4. **Embedded interface not in result set** — If an interface embeds a stdlib interface not in our result (e.g., `io.Reader`), skip the arrow since the parent node doesn't exist in the diagram.\n5. **No interfaces at all** — The overview renders just `classDiagram` with no nodes. This matches current behavior for empty results.\n6. **No embeddings** — Overview shows interface nodes with no arrows. This is correct — it serves as a table of contents.\n7. **Embedded type's Obj().Pkg() is nil** — Universe-scope types like `error` have nil Pkg(). Handle this by checking for nil before accessing `Pkg().Path()`.\n\n## Testing Strategy\n\n1. **Existing test `TestHubAndSpokeSlides`** — Update assertions for overview slide to verify no impl nodes and no `..|\u003e` arrows\n2. **New test `TestOverviewInterfaceEmbedding`** — Verify embedding arrows appear correctly using synthetic interface types\n3. **Manual verification** — Run on testdata/05_embedded_iface to verify ReadCloser → Reader and ReadCloser → Closer arrows appear in overview\n4. **Run `go test ./...`** — All existing tests must pass\n5. **Run `golangci-lint run ./...`** — No lint errors\n6. **Run `bash scripts/visual-verify.sh`** — Visual check of rendered SVGs","status":"closed","priority":2,"issue_type":"task","assignee":"nova","owner":"olesho@gmail.com","created_at":"2026-02-20T05:08:13.910905-06:00","created_by":"Oleh Luchkiv","updated_at":"2026-02-20T09:31:21.174566-06:00","closed_at":"2026-02-20T09:31:21.174566-06:00","close_reason":"Completed: overview slide now shows only interface nodes with embedding arrows (--|\u003e). Implementation blocks, impl arrows (..|\u003e), and implStyle removed. Tests updated and new TestOverviewInterfaceEmbedding added."}
{"id":"test-loom-a0i","title":"Implement HTTP server with Mermaid.js rendering","description":"internal/server/server.go - serves HTML with Mermaid.js CDN v11, zoom controls, copy button, auto-browser-open, graceful shutdown","status":"closed","priority":2,"issue_type":"task","owner":"olesho@gmail.com","created_at":"2026-02-19T09:06:16.076028-06:00","created_by":"Oleh Luchkiv","updated_at":"2026-02-19T09:06:19.490009-06:00","closed_at":"2026-02-19T09:06:19.490009-06:00","close_reason":"Implemented with dark/light mode, zoom, copy, and graceful shutdown"}
{"id":"test-loom-a8u","title":"Implement core analyzer package","description":"internal/analyzer/ - types.go (InterfaceDef, TypeDef, MethodSig, Relation, Result), analyzer.go (package loading via go/packages, interface/type collection, types.Implements matching), filter.go (stdlib/unexported/prefix filtering, orphan pruning)","status":"closed","priority":1,"issue_type":"task","owner":"olesho@gmail.com","created_at":"2026-02-19T09:05:39.671251-06:00","created_by":"Oleh Luchkiv","updated_at":"2026-02-19T09:05:44.098826-06:00","closed_at":"2026-02-19T09:05:44.098826-06:00","close_reason":"Implemented with stdlib interface loading, error builtin handling, and all filtering"}
{"id":"test-loom-awj","title":"Mermaid syntax error when rendering go-memdb diagram in browser","description":"Running './goifaces https://github.com/hashicorp/go-memdb -port 8081' produces a Mermaid diagram that fails to render in the browser with 'Syntax error in text, mermaid version 11.12.3'. Need to investigate the generated Mermaid output for invalid syntax.","status":"closed","priority":1,"issue_type":"bug","owner":"olesho@gmail.com","created_at":"2026-02-19T15:38:56.242547-06:00","created_by":"Oleh Luchkiv","updated_at":"2026-02-19T15:42:24.034549-06:00","closed_at":"2026-02-19T15:42:24.034549-06:00","close_reason":"Closed"}
{"id":"test-loom-ayh","title":"Run visual verification on all test diagrams","description":"Run 'bash scripts/visual-verify.sh' to render all testdata Mermaid outputs to SVG via mmdc. Then visually inspect each SVG to confirm diagrams match the input Go code. Prerequisite: npm install -g @mermaid-js/mermaid-cli","status":"closed","priority":2,"issue_type":"task","owner":"olesho@gmail.com","created_at":"2026-02-19T09:05:40.313985-06:00","created_by":"Oleh Luchkiv","updated_at":"2026-02-19T16:47:39.122746-06:00","closed_at":"2026-02-19T16:47:39.122746-06:00","close_reason":"Closed"}
{"id":"test-loom-bnt","title":"Implement LLM-backed enrichers (iteration 2)","description":"Swap no-op default enrichers with LLM-backed implementations: 1) Semantic grouper - identify architectural layers 2) Pattern detector - recognize design patterns 3) Diagram simplifier - intelligent pruning 4) Annotator - add descriptions 5) Relationship scorer - rank by importance. All interfaces already defined in internal/enricher/.","design":"## Summary\n\nReplace the five no-op/mechanical default enrichers with LLM-backed implementations that provide semantic understanding of Go interface-implementation graphs. This transforms the enricher pipeline from purely syntactic (group-by-package, equal-weight scoring) to semantically intelligent (identify architectural layers, recognize design patterns, smart pruning, human-readable annotations, importance-based scoring). The LLM enrichers degrade gracefully to the existing defaults on failure.\n\n## Technical Approach\n\n### LLM Client Abstraction\n\nCreate a lightweight LLM client in \\`internal/enricher/llm/client.go\\` that speaks the **OpenAI-compatible chat completions API** (the most universal protocol — works with OpenAI, Anthropic via proxy, Ollama, vLLM, any OpenAI-compatible endpoint). No external SDK dependency — use stdlib \\`net/http\\` + \\`encoding/json\\`.\n\nThe client:\n- Takes an endpoint URL, API key, and model name via configuration\n- Sends chat completion requests with JSON mode (\\`response_format: {type: \"json_object\"}\\`)\n- Returns raw JSON string for each enricher to parse into its own typed response\n- Includes timeout, retries (1 retry on 5xx), and structured logging via \\`slog\\`\n\n### Configuration\n\nAdd a CLI flag \\`--enrich\\` (boolean, default false) to enable LLM enrichment. When enabled, read:\n- \\`GOIFACES_LLM_ENDPOINT\\` — API base URL (default: \\`https://api.openai.com/v1\\`)\n- \\`GOIFACES_LLM_API_KEY\\` — API key (required when --enrich is set)\n- \\`GOIFACES_LLM_MODEL\\` — model identifier (default: \\`gpt-4o-mini\\`)\n\nThese are env vars rather than flags because they contain secrets (API key) and rarely change between runs.\n\n### Enricher Implementations\n\nEach LLM enricher lives in a new file \\`internal/enricher/llm_\u003cname\u003e.go\\` (e.g., \\`llm_grouper.go\\`). Each:\n1. Implements the existing \\`Enricher\\` interface plus its domain-specific interface\n2. Takes a \\`*llm.Client\\` and the default enricher as constructor args\n3. Serializes the relevant parts of \\`analyzer.Result\\` into a focused prompt\n4. Parses the JSON response into the expected return type\n5. Falls back to the default enricher on any error (logs the failure at WARN level)\n\n#### 1. LLM Semantic Grouper (\\`llm_grouper.go\\`)\n\n**Prompt strategy:** Send a list of interfaces and types with their package paths, method signatures, and implementation relationships. Ask the LLM to identify architectural layers/domains (e.g., \"Data Access\", \"Business Logic\", \"HTTP Transport\", \"Domain Models\").\n\n**JSON response schema:**\n\\`\\`\\`json\n{\n  \"groups\": [\n    {\n      \"name\": \"Data Access Layer\",\n      \"interfaces\": [\"pkg.InterfaceName\"],\n      \"types\": [\"pkg.TypeName\"]\n    }\n  ]\n}\n\\`\\`\\`\n\n**Enrich behavior:** The \\`Enrich()\\` method returns the result unchanged (grouping is consumed separately by diagram generation). The \\`Group()\\` method returns the LLM-identified semantic groups.\n\n#### 2. LLM Pattern Detector (\\`llm_patterns.go\\`)\n\n**Prompt strategy:** Send the interface graph (interfaces with methods, types, which type implements which interface). Ask the LLM to identify GoF and Go-specific patterns (Strategy, Factory, Repository, Observer, Decorator, Adapter, etc.).\n\n**JSON response schema:**\n\\`\\`\\`json\n{\n  \"patterns\": [\n    {\n      \"name\": \"Strategy\",\n      \"description\": \"Multiple interchangeable algorithms behind a common interface\",\n      \"participants\": [\"pkg.Interface\", \"pkg.ImplA\", \"pkg.ImplB\"]\n    }\n  ]\n}\n\\`\\`\\`\n\n**Enrich behavior:** \\`Enrich()\\` returns result unchanged. \\`Detect()\\` returns detected patterns.\n\n#### 3. LLM Diagram Simplifier (\\`llm_simplifier.go\\`)\n\n**Prompt strategy:** When node count exceeds \\`maxNodes\\`, send the full graph and ask the LLM to identify the \\`maxNodes\\` most architecturally significant nodes to keep, preserving the most informative relationships. The LLM should prefer keeping hub interfaces and types that bridge different domains.\n\n**JSON response schema:**\n\\`\\`\\`json\n{\n  \"keep\": [\"pkg.Name1\", \"pkg.Name2\"]\n}\n\\`\\`\\`\n\n**Enrich behavior:** \\`Enrich()\\` uses the LLM to intelligently select which nodes to keep (rather than the default edge-count heuristic). \\`Simplify()\\` performs the actual filtering based on the LLM's selection.\n\n#### 4. LLM Annotator (\\`llm_annotator.go\\`)\n\n**Prompt strategy:** Send interfaces and types with their methods and relationships. Ask the LLM to generate concise (\u003c 80 char) human-readable descriptions for each, explaining their role/purpose.\n\n**JSON response schema:**\n\\`\\`\\`json\n{\n  \"annotations\": {\n    \"pkg.Name\": \"Brief description of purpose\"\n  }\n}\n\\`\\`\\`\n\n**Enrich behavior:** \\`Enrich()\\` returns result unchanged. \\`Annotate()\\` returns the annotation map.\n\n#### 5. LLM Relationship Scorer (\\`llm_scorer.go\\`)\n\n**Prompt strategy:** Send all relationships (type → interface pairs). Ask the LLM to score each by architectural importance (0.0–1.0), where core domain relationships score high and incidental implementations (e.g., implementing \\`error\\` or \\`fmt.Stringer\\`) score low.\n\n**JSON response schema:**\n\\`\\`\\`json\n{\n  \"scores\": {\n    \"0\": 0.9,\n    \"1\": 0.3\n  }\n}\n\\`\\`\\`\n\nKeys are string-encoded relation indices matching the input order.\n\n**Enrich behavior:** \\`Enrich()\\` returns result unchanged. \\`Score()\\` returns the weighted scores.\n\n### Result Serialization\n\nCreate a helper \\`internal/enricher/llm/serialize.go\\` that converts \\`analyzer.Result\\` into a compact text representation for prompts:\n- List interfaces: name, package, method signatures (truncated if \u003e10 methods)\n- List types: name, package, key methods\n- List relationships: \"TypeName implements InterfaceName\"\n- Keep total prompt size reasonable (estimate ~4K tokens for a medium project)\n\n### Wiring in main.go\n\nWhen \\`--enrich\\` is set:\n1. Create \\`llm.Client\\` from env vars\n2. Replace the enricher pipeline with LLM-backed enrichers:\n   \\`\\`\\`go\n   enrichers := []enricher.Enricher{\n       enricher.NewLLMGrouper(llmClient, enricher.NewDefaultGrouper()),\n       enricher.NewLLMSimplifier(llmClient, enricher.NewDefaultSimplifier()),\n   }\n   \\`\\`\\`\n3. Optionally run pattern detection and annotation as separate steps (their results feed into diagram generation, not the Result pipeline)\n\n### Error Handling \u0026 Fallback\n\nEvery LLM enricher wraps a default enricher. On any error:\n1. Log at WARN level with \\`component=enricher\\`, error details, and which enricher failed\n2. Return the default enricher's result\n3. Continue the pipeline — a single enricher failure does not abort the run\n\n### Token Budget\n\nEach enricher prompt is self-contained and focused. For a medium project (20 interfaces, 50 types, 100 relations):\n- Grouper prompt: ~2K tokens input, ~500 tokens output\n- Pattern detector: ~2K tokens input, ~500 tokens output\n- Simplifier: ~1.5K tokens input, ~200 tokens output\n- Annotator: ~2K tokens input, ~1K tokens output\n- Scorer: ~1K tokens input, ~500 tokens output\n\nTotal: ~12K tokens per run. With gpt-4o-mini at $0.15/1M input + $0.60/1M output, this costs ~$0.002 per run.\n\n## Files to Create\n\n1. **\\`internal/enricher/llm/client.go\\`** — LLM HTTP client (OpenAI-compatible chat completions, JSON mode, retries, timeout)\n2. **\\`internal/enricher/llm/serialize.go\\`** — Helper to serialize \\`analyzer.Result\\` into compact prompt text\n3. **\\`internal/enricher/llm/client_test.go\\`** — Unit tests for client with httptest mock server\n4. **\\`internal/enricher/llm_grouper.go\\`** — LLM-backed semantic grouper\n5. **\\`internal/enricher/llm_patterns.go\\`** — LLM-backed pattern detector\n6. **\\`internal/enricher/llm_simplifier.go\\`** — LLM-backed intelligent simplifier\n7. **\\`internal/enricher/llm_annotator.go\\`** — LLM-backed annotator\n8. **\\`internal/enricher/llm_scorer.go\\`** — LLM-backed relationship scorer\n\n## Files to Modify\n\n1. **\\`main.go\\`** — Add \\`--enrich\\` flag, env var reading, conditional LLM enricher pipeline construction\n2. **\\`docs/architecture.md\\`** — Document the LLM enricher subsystem, client abstraction, fallback behavior\n3. **\\`docs/cli-reference.md\\`** — Document \\`--enrich\\` flag and required env vars\n4. **\\`internal/integration_test.go\\`** — Add integration test for LLM enricher pipeline (using mock HTTP server)\n\n## Dependencies\n\n- **No new external Go modules required** — uses stdlib \\`net/http\\` + \\`encoding/json\\` for the LLM client\n- Internal: depends on \\`internal/analyzer\\` (types), \\`internal/enricher\\` (interfaces)\n- External runtime: requires an OpenAI-compatible API endpoint when \\`--enrich\\` is enabled\n\n## Edge Cases \u0026 Error Handling\n\n1. **Missing API key with --enrich**: Print clear error message and exit (fail fast, don't silently fall back)\n2. **LLM returns malformed JSON**: Log warning, fall back to default enricher\n3. **LLM returns valid JSON but missing/extra fields**: Use what's available, ignore extras, fall back for missing\n4. **LLM timeout (default 30s per request)**: Log warning, fall back to default\n5. **LLM returns node keys that don't match any actual node**: Ignore unknown keys, only use valid references\n6. **Empty result (0 interfaces/types)**: Skip LLM calls entirely, return defaults immediately\n7. **Very large projects (\u003e100 types)**: Truncate the prompt by including only the most-connected nodes (pre-filter using edge count before sending to LLM)\n8. **Rate limiting (429)**: Respect Retry-After header, retry once, then fall back\n\n## Testing Strategy\n\n### Unit Tests\n- **\\`internal/enricher/llm/client_test.go\\`**: Test HTTP client against \\`httptest\\` mock server — success, timeout, 5xx retry, malformed response, JSON mode header\n- Each LLM enricher file gets table-driven tests with mock LLM responses (use a mock client interface)\n\n### Integration Tests\n- Add test in \\`internal/integration_test.go\\` that:\n  1. Starts a mock HTTP server returning canned LLM responses\n  2. Creates LLM enrichers pointed at the mock\n  3. Runs the full pipeline on testdata/01_single_iface\n  4. Asserts the enriched result has groups, patterns, annotations, scores\n  5. Tests fallback: mock returns 500, verify default enricher result is used\n\n### Manual Verification\n- Run \\`goifaces --enrich ./testdata/01_single_iface -output test.mmd\\` against a real LLM endpoint\n- Inspect logs for LLM request/response details at DEBUG level\n- Compare diagram output with and without \\`--enrich\\` flag","status":"open","priority":4,"issue_type":"feature","owner":"olesho@gmail.com","created_at":"2026-02-19T09:05:44.690964-06:00","created_by":"Oleh Luchkiv","updated_at":"2026-02-20T09:20:03.793947-06:00"}
{"id":"test-loom-co9","title":"Break large diagrams into paginated slides for readability","description":"Large diagrams like go-memdb produce a single very wide Mermaid chart that's too small to read. Need to split large diagrams into multiple slides/pages. Approach options: (1) Group by interface — each slide shows one interface and its implementors, (2) Group by package — each slide shows one package's types and interfaces, (3) Auto-partition by node count — split when diagram exceeds N nodes. The HTML server should add slide navigation (prev/next/overview). Each slide is a separate Mermaid diagram. An overview slide could show just the relationship graph without method details. Consider also adding a sidebar navigation listing all interfaces/types for quick jumping.","status":"closed","priority":2,"issue_type":"feature","owner":"olesho@gmail.com","created_at":"2026-02-19T16:27:53.624251-06:00","created_by":"Oleh Luchkiv","updated_at":"2026-02-19T16:47:39.028799-06:00","closed_at":"2026-02-19T16:47:39.028799-06:00","close_reason":"Closed"}
{"id":"test-loom-dih","title":"Create project documentation","description":"CLAUDE.md (agent rules), AGENTS.md (agent workflow), docs/architecture.md, docs/cli-reference.md, docs/logging.md, docs/development.md, scripts/visual-verify.sh","status":"closed","priority":2,"issue_type":"task","owner":"olesho@gmail.com","created_at":"2026-02-19T09:06:39.4316-06:00","created_by":"Oleh Luchkiv","updated_at":"2026-02-19T09:06:43.273698-06:00","closed_at":"2026-02-19T09:06:43.273698-06:00","close_reason":"All docs and scripts created"}
{"id":"test-loom-dl6","title":"Create integration test suite with 10 testdata scenarios","description":"internal/integration_test.go with 12 subtests across 10 testdata dirs. Each testdata dir is a self-contained Go module. Tests cover: single iface, multi impl, multi iface, pointer receiver, embedded iface, cross-package, stdlib ifaces (with/without), empty iface, unexported (with/without), diamond pattern.","status":"closed","priority":1,"issue_type":"task","owner":"olesho@gmail.com","created_at":"2026-02-19T09:06:32.183689-06:00","created_by":"Oleh Luchkiv","updated_at":"2026-02-19T09:06:35.529773-06:00","closed_at":"2026-02-19T09:06:35.529773-06:00","close_reason":"All 12 tests passing. Fixed stdlib module paths, added stdlib package loading, and error builtin handling."}
{"id":"test-loom-f0x","title":"Color-code interfaces vs implementations in Mermaid diagrams","description":"Use Mermaid classDiagram styling (classDef + cssClass) to visually distinguish interfaces from concrete types. For example, interfaces in blue/teal and implementations in green/gray. This makes it immediately obvious which boxes are contracts vs implementations when viewing the diagram. Implementation is in internal/diagram/mermaid.go — add classDef statements after the classDiagram header and apply them to interface vs type nodes.","status":"closed","priority":2,"issue_type":"feature","owner":"olesho@gmail.com","created_at":"2026-02-19T11:43:00.117332-06:00","created_by":"Oleh Luchkiv","updated_at":"2026-02-19T12:59:07.123668-06:00","closed_at":"2026-02-19T12:59:07.123668-06:00","close_reason":"Implemented in a20df86. Interfaces blue (#2374ab), implementations green (#4a9c6d) via Mermaid classDef + cssClass."}
{"id":"test-loom-f13","title":"Implement hub-and-spoke slide splitting strategy","description":"Implement the first concrete Splitter strategy: hub-and-spoke.\n\nAlgorithm:\n1. Classify nodes by connection count:\n   - 'Hub' nodes (reusable): interfaces/types with connections \u003e= threshold (e.g., 3+). These appear on EVERY slide as context.\n   - 'Spoke' nodes (non-reusable): implementations with fewer connections. These are chunked into groups.\n\n2. Group spoke nodes into chunks of N (configurable, default 3-4 per slide).\n\n3. For each chunk, build a slide containing:\n   - All hub nodes (the shared interfaces)\n   - The chunk's spoke nodes (implementations)\n   - Only the relations connecting these specific nodes\n\n4. Slide 0 remains the overview (all nodes, no methods).\n\nExample with go-memdb:\n- Hubs: memdb_Indexer, memdb_MultiIndexer, memdb_SingleIndexer, memdb_PrefixIndexer (4+ connections each)\n- Spokes: BoolFieldIndex, CompoundMultiIndex, ConditionalIndex, etc. (3 connections each)\n- Slides: chunks of 3 spokes + all hubs\n\nEdge cases:\n- A node that's both high-connectivity AND an implementation stays as a hub\n- ResultIterator + FilterIterator form their own small cluster — they should be grouped together\n- If total nodes \u003c= threshold, return single slide (no splitting)\n\nDepends on: splitter abstraction task.","status":"closed","priority":1,"issue_type":"feature","owner":"olesho@gmail.com","created_at":"2026-02-19T17:07:23.512936-06:00","created_by":"Oleh Luchkiv","updated_at":"2026-02-19T19:19:24.213173-06:00","closed_at":"2026-02-19T19:19:24.213173-06:00","close_reason":"Implemented in hub-and-spoke slide splitting session: split package with Splitter interface, HubAndSpoke strategy, CLI flags, integration tests. All tests + linter pass.","dependencies":[{"issue_id":"test-loom-f13","depends_on_id":"test-loom-wa8","type":"blocks","created_at":"2026-02-19T17:07:38.275703-06:00","created_by":"Oleh Luchkiv"}]}
{"id":"test-loom-ije","title":"Replace dash-dotted arrow lines with solid ones in Mermaid diagrams","design":"## Summary\n\nReplace the Mermaid `..|\u003e` (dashed/dash-dotted realization arrow) with `--|\u003e` (solid inheritance arrow) in all generated class diagrams. Currently, `writeRelation` in `mermaid.go` uses `..|\u003e` which renders as a dashed line in Mermaid. The task asks for solid lines instead, which is `--|\u003e` in Mermaid syntax. This is a cosmetic change affecting diagram output only — no logic or architecture changes.\n\n## Technical Approach\n\nThis is a simple string replacement. In Mermaid classDiagram syntax:\n- `..|\u003e` = dashed line with open arrowhead (UML \"realization\")\n- `--|\u003e` = solid line with open arrowhead (UML \"inheritance\")\n\nThe single source of truth is the `writeRelation` function in `mermaid.go`. All tests that assert on the arrow syntax also need updating.\n\nNo new dependencies, no new patterns, no architectural decisions.\n\n## Files to Modify\n\n### 1. `goifaces/internal/diagram/mermaid.go` (line 188)\nChange the format string in `writeRelation` from `..|\u003e` to `--|\u003e`:\n```go\n// Before:\nline := fmt.Sprintf(\"    %s ..|\u003e %s\", typeID, ifaceID)\n// After:\nline := fmt.Sprintf(\"    %s --|\u003e %s\", typeID, ifaceID)\n```\nThis is the ONLY production code change.\n\n### 2. `goifaces/internal/integration_test.go` (multiple lines)\nUpdate all test assertions and the `normalizeOutput` helper to use `--|\u003e` instead of `..|\u003e`:\n\n**`normalizeOutput` function (line 82):** Change the relation-detection string:\n```go\n// Before:\n} else if strings.Contains(trimmed, \"..|\u003e\") {\n// After:\n} else if strings.Contains(trimmed, \"--|\u003e\") {\n```\n\n**All `assert.Contains` / `assert.NotContains` calls** that check for `..|\u003e` relations (lines 141, 153, 154, 170-176, 186, 199-201, 211, 236, 249, 260, 276-278, 291-293). Each `..|\u003e` becomes `--|\u003e`. Full list:\n- Line 141: `shapes_Circle ..|\u003e shapes_Shape` → `shapes_Circle --|\u003e shapes_Shape`\n- Line 153: `animals_Dog ..|\u003e animals_Speaker` → `animals_Dog --|\u003e animals_Speaker`\n- Line 154: `animals_Cat ..|\u003e animals_Speaker` → `animals_Cat --|\u003e animals_Speaker`\n- Line 170: `store_MemStore ..|\u003e store_Reader` → `store_MemStore --|\u003e store_Reader`\n- Line 171: `store_MemStore ..|\u003e store_Writer` → `store_MemStore --|\u003e store_Writer`\n- Line 172: `store_MemStore ..|\u003e store_ReadWriter` → `store_MemStore --|\u003e store_ReadWriter`\n- Line 174: `store_ReadOnlyCache ..|\u003e store_Reader` → `store_ReadOnlyCache --|\u003e store_Reader`\n- Line 175: `store_ReadOnlyCache ..|\u003e store_Writer` → `store_ReadOnlyCache --|\u003e store_Writer`\n- Line 176: `store_ReadOnlyCache ..|\u003e store_ReadWriter` → `store_ReadOnlyCache --|\u003e store_ReadWriter`\n- Line 186: `db_Connection ..|\u003e db_Closer` → `db_Connection --|\u003e db_Closer`\n- Line 199: `io2_MyFile ..|\u003e io2_Reader` → `io2_MyFile --|\u003e io2_Reader`\n- Line 200: `io2_MyFile ..|\u003e io2_Closer` → `io2_MyFile --|\u003e io2_Closer`\n- Line 201: `io2_MyFile ..|\u003e io2_ReadCloser` → `io2_MyFile --|\u003e io2_ReadCloser`\n- Line 211: `impl_ConsoleLogger ..|\u003e ifaces_Logger` → `impl_ConsoleLogger --|\u003e ifaces_Logger`\n- Line 236: `assert.NotContains(t, normalized, \"..|\u003e\")` → `assert.NotContains(t, normalized, \"--|\u003e\")`\n- Line 249: `assert.NotContains(t, normalized, \"..|\u003e\")` → `assert.NotContains(t, normalized, \"--|\u003e\")`\n- Line 260: `internal_Cat ..|\u003e internal_Runner` → `internal_Cat --|\u003e internal_Runner`\n- Line 276: `internal_dog ..|\u003e internal_walker` → `internal_dog --|\u003e internal_walker`\n- Line 277: `internal_dog ..|\u003e internal_Runner` → `internal_dog --|\u003e internal_Runner`\n- Line 278: `internal_Cat ..|\u003e internal_Runner` → `internal_Cat --|\u003e internal_Runner`\n- Line 291: `diamond_DB ..|\u003e diamond_Saver` → `diamond_DB --|\u003e diamond_Saver`\n- Line 292: `diamond_DB ..|\u003e diamond_Loader` → `diamond_DB --|\u003e diamond_Loader`\n- Line 293: `diamond_DB ..|\u003e diamond_Persister` → `diamond_DB --|\u003e diamond_Persister`\n\n## Files to Create\nNone.\n\n## Dependencies\nNone. No external packages needed. This is a pure string replacement.\n\n## Edge Cases \u0026 Error Handling\n- No edge cases — this is a deterministic string replacement with no conditional logic.\n- The `normalizeOutput` test helper in `integration_test.go` uses `..|\u003e` to detect relation lines during parsing. This MUST be updated to `--|\u003e` or the test normalizer will silently skip relation lines, causing false test passes.\n\n## Testing Strategy\n1. Run the full test suite: `cd goifaces \u0026\u0026 go test ./...`\n2. All 11 end-to-end test cases plus the hub-and-spoke slide test should pass.\n3. Manually verify by running the tool on any testdata directory and inspecting the output contains `--|\u003e` (solid arrows) instead of `..|\u003e` (dashed arrows).","notes":"BLOCKED: Source code files do not exist in the repository. The design references goifaces/internal/diagram/mermaid.go and goifaces/internal/integration_test.go, but the repo only contains the initial commit with .beads/issues.jsonl and AGENTS.md. All branches (main, nova, falcon, spark) point to the same initial commit. The goifaces project code was never committed to this repository. Cannot modify files that don't exist.","status":"closed","priority":2,"issue_type":"task","assignee":"nova","owner":"olesho@gmail.com","created_at":"2026-02-20T05:02:17.855914-06:00","created_by":"Oleh Luchkiv","updated_at":"2026-02-20T13:17:06.228321-06:00","closed_at":"2026-02-20T13:17:06.228321-06:00","close_reason":"Replaced ..|\u003e with --|\u003e in mermaid.go and all test assertions"}
{"id":"test-loom-izp","title":"Wire splitter into main pipeline and test with go-memdb","description":"Wire the hub-and-spoke splitter into main.go and ServeSlides. Verify with go-memdb that:\n1. Overview slide shows all 17 nodes with no methods\n2. Each detail slide shows 3-4 implementations + the shared interfaces they connect to\n3. All relations are preserved (no missing arrows)\n4. Slides are navigable via prev/next/picker\n5. Each slide's Mermaid validates via scripts/verify-mermaid.sh\n\nAdd integration test: build slides for go-memdb-like synthetic data, assert slide count and hub presence on each slide.\n\nDepends on: hub-and-spoke implementation task.","status":"closed","priority":1,"issue_type":"task","owner":"olesho@gmail.com","created_at":"2026-02-19T17:07:28.151922-06:00","created_by":"Oleh Luchkiv","updated_at":"2026-02-19T19:19:24.215067-06:00","closed_at":"2026-02-19T19:19:24.215067-06:00","close_reason":"Implemented in hub-and-spoke slide splitting session: split package with Splitter interface, HubAndSpoke strategy, CLI flags, integration tests. All tests + linter pass.","dependencies":[{"issue_id":"test-loom-izp","depends_on_id":"test-loom-f13","type":"blocks","created_at":"2026-02-19T17:07:38.349872-06:00","created_by":"Oleh Luchkiv"}]}
{"id":"test-loom-jzu","title":"Show file paths in Mermaid diagram blocks for interfaces and implementations","description":"Add source file path information to each class block in the generated Mermaid diagram. Both interface and implementation blocks should display the file path where they are defined. This requires: (1) capturing file position during analysis in analyzer.go (using go/packages token position info), (2) storing file path in InterfaceDef and TypeDef structs in types.go, (3) rendering the file path in the Mermaid class block in mermaid.go (e.g. as a note or first line in the block). The file path should be relative to the analyzed module root for readability.","status":"closed","priority":2,"issue_type":"feature","owner":"olesho@gmail.com","created_at":"2026-02-19T16:24:30.267171-06:00","created_by":"Oleh Luchkiv","updated_at":"2026-02-19T16:43:48.378403-06:00","closed_at":"2026-02-19T16:43:48.378403-06:00","close_reason":"Closed"}
{"id":"test-loom-mce","title":"Smoke test goifaces against real Go repositories","description":"Test the binary against real repos: 1) ./goifaces https://github.com/hashicorp/go-memdb 2) ./goifaces on the goifaces project itself 3) A large repo to stress-test. Verify diagrams render correctly, logs are valid JSONL, and edge cases (compile errors, missing deps) produce warnings not crashes.","status":"closed","priority":2,"issue_type":"task","owner":"olesho@gmail.com","created_at":"2026-02-19T09:05:41.428593-06:00","created_by":"Oleh Luchkiv","updated_at":"2026-02-19T16:48:48.592292-06:00","closed_at":"2026-02-19T16:48:48.592292-06:00","close_reason":"Closed"}
{"id":"test-loom-snp","title":"Scaffold goifaces project structure","description":"go mod init, directory structure, .golangci.yml, .githooks/pre-commit, .gitignore, git init with custom hooks path","status":"closed","priority":1,"issue_type":"task","owner":"olesho@gmail.com","created_at":"2026-02-19T09:05:22.110035-06:00","created_by":"Oleh Luchkiv","updated_at":"2026-02-19T09:05:26.501622-06:00","closed_at":"2026-02-19T09:05:26.501622-06:00","close_reason":"Project scaffolded with all dirs, configs, and git hooks"}
{"id":"test-loom-vnu","title":"Implement main.go CLI entry point","description":"main.go - flag parsing (path, port, filter, include-stdlib, include-unexported, output, no-browser, log-file, log-level), pipeline orchestration, signal handling","status":"closed","priority":1,"issue_type":"task","owner":"olesho@gmail.com","created_at":"2026-02-19T09:06:24.159055-06:00","created_by":"Oleh Luchkiv","updated_at":"2026-02-19T09:06:27.84161-06:00","closed_at":"2026-02-19T09:06:27.84161-06:00","close_reason":"Full pipeline wired: resolve → analyze → filter → enrich → diagram → serve/write"}
{"id":"test-loom-wa8","title":"Design splitter abstraction as a decoupled module","description":"Create a Splitter interface in internal/diagram/split/ (new subpackage) that takes an *analyzer.Result and returns []Slide. The interface should be strategy-based so we can swap different splitting algorithms without touching the rest of the codebase.\n\nKey design:\n- type Splitter interface { Split(result *analyzer.Result, opts SplitOptions) []Slide }\n- SplitOptions carries config: max implementations per slide, min connections to be 'reusable', etc.\n- The existing BuildSlides() in slides.go becomes a thin wrapper that delegates to a Splitter\n- Splitters are composed in main.go, not hardcoded\n\nThis is the abstraction layer only — no concrete strategy implementation.","status":"closed","priority":1,"issue_type":"task","owner":"olesho@gmail.com","created_at":"2026-02-19T17:07:15.357225-06:00","created_by":"Oleh Luchkiv","updated_at":"2026-02-19T19:19:24.209267-06:00","closed_at":"2026-02-19T19:19:24.209267-06:00","close_reason":"Implemented in hub-and-spoke slide splitting session: split package with Splitter interface, HubAndSpoke strategy, CLI flags, integration tests. All tests + linter pass."}
{"id":"test-loom-xf7","title":"Remove method names from implementation blocks in Mermaid diagrams","description":"Remove method names from implementation (green) blocks in Mermaid class diagrams. Methods are already shown in interface blocks, so impl blocks should only display the struct name. This reduces visual clutter especially for large repos like go-memdb.\n\nChanges needed:\n1. internal/diagram/mermaid.go - writeTypeBlock: stop writing method lines, just emit class name + source file comment. Remove now-unused buildRelevantMethodsMap function. Remove relevantSet passing from GenerateMermaid.\n2. internal/diagram/slides.go - generateOverviewMermaid: add 'direction LR' after classDiagram (was missed in previous LR change).\n3. internal/integration_test.go - TestHubAndSpokeSlides overview assertion (line 422) checks no '+' lines — still valid. Detail slide assertions are fine since methods come from interface blocks.\n4. Run go test ./..., golangci-lint run ./..., bash scripts/visual-verify.sh (rebuild binary first with go build -o goifaces .)\n5. Update docs/architecture.md to note impl blocks show only type names.\n\nNOTE: mermaid.go already has partial edits applied (buildRelevantMethodsMap removed, writeTypeBlock simplified, relevantSet removed from GenerateMermaid call). Verify the current state and complete any remaining work.","design":"## Summary\n\nThis task removes method names from implementation (green) blocks in Mermaid class diagrams. Methods are already shown in interface (blue) blocks, so repeating them in impl blocks is redundant visual clutter — especially for large repos like go-memdb with many implementations. The task also ensures slides.go has 'direction LR' in the overview diagram, and updates architecture documentation.\n\n**NOTE: The code changes described in the task description have already been applied to the codebase.** The implementing agent's primary job is to VERIFY the current state is correct and run the full validation pipeline (tests, lint, visual-verify).\n\n## Technical Approach\n\nThe approach is straightforward: `writeTypeBlock` in mermaid.go was simplified to only emit the struct name and source file comment — no method lines. The `buildRelevantMethodsMap` function (which built a lookup of methods to display on type blocks) was removed as it's no longer needed. The `relevantSet` parameter was removed from `GenerateMermaid`'s call chain.\n\nThis is safe because:\n- Interface blocks already display all method signatures with `+MethodName()` syntax\n- Relation arrows (`Type ..|\u003e Interface`) clearly show which types implement which interfaces\n- Removing duplicate method listings significantly declutters diagrams for repos with many implementations\n\n## Files to Create\n\nNone.\n\n## Files to Modify\n\nAll changes below appear to be ALREADY APPLIED. The implementing agent should verify each one:\n\n### 1. `internal/diagram/mermaid.go`\n**Verify current state:**\n- `writeTypeBlock` (lines 158-165): Should only write `class ID { }` with an optional `%% file:` comment. Should NOT call `writeMethodLines` or emit any `+MethodName()` lines.\n- `buildRelevantMethodsMap`: Should NOT exist anywhere in the file.\n- `GenerateMermaid` (line 23): Should NOT accept or pass a `relevantSet` parameter. The call to `writeTypeBlock` on line 84 should take only `(\u0026b, typ)`.\n- `writeMethodLines` should only be called from `writeInterfaceBlock` (line 151).\n\n**If any of the above are NOT already applied:** Apply the missing changes per the task description.\n\n### 2. `internal/diagram/slides.go`\n**Verify current state:**\n- `generateOverviewMermaid` should have `direction LR` after `classDiagram` (currently line 154).\n- Type blocks in the overview should be empty (no methods), which they already are by design of this function.\n\n### 3. `internal/integration_test.go`\n**Verify current state:**\n- Line 422: `assert.NotContains(t, overview, \"+\", \"overview should have no method lines\")` — this assertion validates overview has no method `+` lines. Should remain as-is.\n- All other test assertions check for method names like `Area()` in the full diagram output. These will still pass because methods appear in interface blocks (via `writeInterfaceBlock` → `writeMethodLines`).\n- No test changes needed.\n\n### 4. `docs/architecture.md`\n**Verify current state:**\n- Line 51 should contain text explaining that implementation blocks show only the type name and methods are omitted. Currently reads: \"implementation blocks (green) show only the type name -- methods are omitted from impl blocks because they are already listed in the interface blocks, reducing visual clutter.\"\n\n## Dependencies\n\n- No external packages needed\n- No internal module changes needed\n- No blocking tasks\n\n## Edge Cases \u0026 Error Handling\n\n1. **Types with no SourceFile:** `writeTypeBlock` handles this — the `%% file:` comment is conditional on `typ.SourceFile != \"\"`. Verify this still works.\n2. **Overview vs detail slides:** Overview diagrams (slides.go) already omit methods from both interface AND type blocks. Detail slides show methods only in interface blocks. Verify both render correctly.\n3. **Empty diagrams:** Tests 07 (no stdlib) and 08 (empty iface) produce empty diagrams — verify they still pass.\n\n## Testing Strategy\n\n### Automated Tests\nRun: `cd /Users/olehluchkiv/Work/test-loom/goifaces \u0026\u0026 go test ./...`\n\nKey tests to verify pass:\n- `TestEndToEnd` — all 11 subtests, especially:\n  - `01_single_iface`: confirms `Area()` still appears (in interface block)\n  - `11_source_file_path`: confirms `%% file:` comments still appear\n- `TestHubAndSpokeSlides` — especially line 422 assertion that overview has no `+` method lines\n\n### Lint\nRun: `cd /Users/olehluchkiv/Work/test-loom/goifaces \u0026\u0026 golangci-lint run ./...`\n\n### Visual Verification\nRun:\n```bash\ncd /Users/olehluchkiv/Work/test-loom/goifaces\ngo build -o goifaces .\nbash scripts/visual-verify.sh\n```\nThen read a few output SVGs (e.g., `testdata/01_single_iface/output.svg`, `testdata/03_multi_iface/output.svg`) to visually confirm:\n- Interface blocks (blue) show method signatures\n- Implementation blocks (green) show ONLY the type name (no methods)\n- Relation arrows are intact\n\n### Manual Spot-Check\nAfter visual-verify, read the raw `.mmd` output for `testdata/01_single_iface/output.mmd` and verify:\n- The Shape interface block contains `+Area()` \n- The Circle impl block does NOT contain `+Area()` — only the class name and `%% file:` comment","status":"closed","priority":2,"issue_type":"task","assignee":"spark","owner":"olesho@gmail.com","created_at":"2026-02-20T04:56:36.227111-06:00","created_by":"Oleh Luchkiv","updated_at":"2026-02-20T13:16:25.010019-06:00","closed_at":"2026-02-20T13:16:25.010019-06:00","close_reason":"Verified all code changes already applied. Tests pass, lint clean, visual-verify correct. Code review: no issues."}
{"id":"test-loom-xp4","title":"Support flags after positional arguments in CLI","description":"Go's flag package stops parsing at the first non-flag argument, so 'goifaces ./path -output file.md' doesn't work — flags must come before the positional arg. Consider switching to pflag or manually parsing args to support both orderings.","status":"closed","priority":3,"issue_type":"bug","owner":"olesho@gmail.com","created_at":"2026-02-19T09:05:42.944588-06:00","created_by":"Oleh Luchkiv","updated_at":"2026-02-19T11:04:29.439666-06:00","closed_at":"2026-02-19T11:04:29.439666-06:00","close_reason":"Fixed in 045b6fb. Added reorderArgs() to support flags in any position."}
{"id":"test-loom-ymy","title":"Remote repo cloning fails to resolve Go module - packages not loaded","description":"When analyzing a remote GitHub repo (e.g. https://github.com/vxcontrol/pentagi), the tool clones successfully but fails at go mod download with 'no modules specified' and package loading fails with 'directory prefix . does not contain main module'. The tool likely isn't setting the working directory to the cloned repo path before running Go commands. Repro: ./goifaces https://github.com/vxcontrol/pentagi -port 8084","status":"closed","priority":1,"issue_type":"bug","assignee":"spark","owner":"olesho@gmail.com","created_at":"2026-02-20T16:30:51.025652-06:00","created_by":"Oleh Luchkiv","updated_at":"2026-02-20T16:34:52.17451-06:00","closed_at":"2026-02-20T16:34:52.17451-06:00","close_reason":"Fixed: added findModuleRootRecursive to search subdirs for go.mod after cloning"}
{"id":"test-loom-z87","title":"Slide threshold prevents splitting for go-memdb (17 nodes \u003c 20)","description":"go-memdb has 5 interfaces + 12 types = 17 nodes. The default slide threshold is 20, so BuildSlides returns a single Full Diagram slide and never invokes the splitter. The threshold should account for relation density, not just node count. A graph with 17 nodes and 38 relations is highly connected and benefits from splitting.","status":"closed","priority":1,"issue_type":"bug","owner":"olesho@gmail.com","created_at":"2026-02-19T19:29:55.026577-06:00","created_by":"Oleh Luchkiv","updated_at":"2026-02-19T19:31:45.835999-06:00","closed_at":"2026-02-19T19:31:45.835999-06:00","close_reason":"Fixed threshold check to also split when relation count \u003e= threshold. go-memdb (17 nodes, 38 relations) now produces 5 slides."}
